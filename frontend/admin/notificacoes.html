<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notifica√ß√µes - OcupaMais Admin</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="icon" type="image/png" href="/frontend/assets/logo-arvore.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    /* Header administrativo */
    .admin-header {
      background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
      color: white;
      padding: 20px 0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .admin-header h1 {
      margin: 0;
      font-size: 2rem;
      font-weight: 600;
    }

    .admin-header p {
      margin: 5px 0 0 0;
      opacity: 0.9;
      font-size: 1.1rem;
    }

    /* Navega√ß√£o */
    .admin-nav {
      background-color: white;
      padding: 15px 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .admin-nav .nav-link {
      color: #2e7d32;
      font-weight: 500;
      padding: 10px 20px;
      border-radius: 25px;
      transition: all 0.3s ease;
      margin: 0 5px;
    }

    .admin-nav .nav-link:hover,
    .admin-nav .nav-link.active {
      background-color: #2e7d32;
      color: white;
    }

    /* Painel de notifica√ß√µes */
    .notifications-panel {
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .notifications-header {
      background: linear-gradient(135deg, #2e7d32, #4caf50);
      color: white;
      padding: 20px 30px;
      border-bottom: none;
    }

    .notifications-header h3 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .notifications-header p {
      margin: 5px 0 0 0;
      opacity: 0.9;
    }

    /* Lista de notifica√ß√µes */
    .notifications-list {
      padding: 0;
      margin: 0;
    }

    .notification-item {
      border-bottom: 1px solid #e9ecef;
      padding: 20px 30px;
      transition: background-color 0.3s ease;
      position: relative;
    }

    .notification-item:hover {
      background-color: #f8f9fa;
    }

    .notification-item:last-child {
      border-bottom: none;
    }

    .notification-item.unread {
      background-color: #f0f8f0;
      border-left: 4px solid #2e7d32;
    }

    .notification-item.unread::before {
      content: '';
      position: absolute;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      width: 8px;
      height: 8px;
      background-color: #2e7d32;
      border-radius: 50%;
    }

    .notification-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .notification-icon.info {
      background: linear-gradient(135deg, #17a2b8, #20c997);
    }

    .notification-icon.warning {
      background: linear-gradient(135deg, #ffc107, #fd7e14);
    }

    .notification-icon.danger {
      background: linear-gradient(135deg, #dc3545, #e83e8c);
    }

    .notification-icon.success {
      background: linear-gradient(135deg, #28a745, #20c997);
    }

    .notification-icon.primary {
      background: linear-gradient(135deg, #007bff, #6610f2);
    }

    .notification-content {
      flex: 1;
    }

    .notification-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 5px;
    }

    .notification-text {
      color: #6c757d;
      font-size: 0.95rem;
      line-height: 1.4;
      margin-bottom: 8px;
    }

    .notification-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }

    .notification-time {
      color: #adb5bd;
      font-size: 0.85rem;
    }

    .notification-actions {
      display: flex;
      gap: 10px;
    }

    .notification-actions .btn {
      font-size: 0.8rem;
      padding: 4px 12px;
    }

    /* Filtros */
    .filters-section {
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .filter-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .filter-btn {
      border-radius: 20px;
      padding: 8px 16px;
      font-size: 0.9rem;
      transition: all 0.3s ease;
    }

    .filter-btn.active {
      background-color: #2e7d32;
      border-color: #2e7d32;
      color: white;
    }

    /* Estado vazio */
    .empty-state {
      text-align: center;
      padding: 60px 30px;
      color: #6c757d;
    }

    .empty-state i {
      font-size: 4rem;
      color: #dee2e6;
      margin-bottom: 20px;
    }

    .empty-state h4 {
      color: #495057;
      margin-bottom: 10px;
    }

    /* Responsividade */
    @media (max-width: 768px) {
      .admin-header h1 {
        font-size: 1.5rem;
      }

      .admin-header p {
        font-size: 1rem;
      }

      .notification-item {
        padding: 15px 20px;
      }

      .notification-meta {
        flex-direction: column;
        align-items: flex-start;
      }

      .notification-actions {
        margin-top: 10px;
      }

      .filters-section {
        padding: 15px;
      }

      .filter-buttons {
        justify-content: center;
      }
    }

    @media (max-width: 576px) {
      .admin-nav .nav-link {
        padding: 8px 15px;
        font-size: 0.9rem;
        margin: 2px;
      }

      .notification-icon {
        width: 40px;
        height: 40px;
        font-size: 16px;
      }

      .notification-title {
        font-size: 1rem;
      }

      .notification-text {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <!-- Header administrativo -->
  <div class="admin-header">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1><i class="fas fa-bell"></i> Notifica√ß√µes</h1>
          <p>Central de notifica√ß√µes do sistema - OcupaMais</p>
        </div>
        <div class="col-md-4 text-right">
          <span class="badge badge-light" style="font-size: 0.9rem;">
            <i class="fas fa-clock"></i> Atualizado agora
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Navega√ß√£o -->
  <div class="admin-nav">
    <div class="container">
      <nav class="nav">
        <a class="nav-link" href="publicacoes.html">
          <i class="fas fa-file-alt"></i> Publica√ß√µes
        </a>
        <a class="nav-link" href="relatorios.html">
          <i class="fas fa-chart-bar"></i> Relat√≥rios
        </a>
        <a class="nav-link active" href="notificacoes.html">
          <i class="fas fa-bell"></i> Notifica√ß√µes
        </a>
      </nav>
    </div>
  </div>

  <div class="container">
    <!-- Filtros -->
    <div class="filters-section">
      <h5 class="mb-3"><i class="fas fa-filter"></i> Filtrar Notifica√ß√µes</h5>
      <div class="filter-buttons">
        <button class="btn btn-outline-secondary filter-btn active" data-filter="all">
          <i class="fas fa-list"></i> Todas
        </button>
        <button class="btn btn-outline-primary filter-btn" data-filter="unread">
          <i class="fas fa-circle"></i> N√£o Lidas
        </button>
        <button class="btn btn-outline-success filter-btn" data-filter="publications">
          <i class="fas fa-file-alt"></i> Publica√ß√µes
        </button>
        <button class="btn btn-outline-warning filter-btn" data-filter="system">
          <i class="fas fa-cog"></i> Sistema
        </button>
        <button class="btn btn-outline-danger filter-btn" data-filter="alerts">
          <i class="fas fa-exclamation-triangle"></i> Alertas
        </button>
      </div>
    </div>

    <!-- Painel de notifica√ß√µes -->
    <div class="notifications-panel">
      <div class="notifications-header">
        <h3><i class="fas fa-bell"></i> Notifica√ß√µes do Sistema</h3>
        <p>Centralize todas as informa√ß√µes importantes</p>
      </div>

      <div class="notifications-list" id="notificationsList">
        <!-- Notifica√ß√µes ser√£o inseridas aqui via JavaScript -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // Configura√ß√£o da API
    // Removido API_BASE_URL - usando dados locais
    
    // Estado da aplica√ß√£o
    let notifications = [];
    let currentFilter = 'all';

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      loadNotifications();
      setupEventListeners();
    });

    // Carregar notifica√ß√µes do backend
    function loadNotifications() {
      // Dados locais simulados
      notifications = [
        {
          id: 1,
          type: 'new_post',
          icon: 'üìù',
          iconClass: 'text-primary',
          title: 'Nova Publica√ß√£o',
          text: 'Jo√£o Silva publicou sobre o Parque Central',
          time: '2 horas atr√°s',
          status: 'unread',
          badge: 'badge-primary',
          badgeText: 'Nova',
          prioridade: 'alta'
        },
        {
          id: 2,
          type: 'status_change',
          icon: 'üîÑ',
          iconClass: 'text-warning',
          title: 'Status Alterado',
          text: 'Publica√ß√£o da Pra√ßa da Liberdade mudou para "Em An√°lise"',
          time: '1 dia atr√°s',
          status: 'read',
          badge: 'badge-warning',
          badgeText: 'Atualiza√ß√£o',
          prioridade: 'media'
        },
        {
          id: 3,
          type: 'system',
          icon: '‚öôÔ∏è',
          iconClass: 'text-info',
          title: 'Manuten√ß√£o do Sistema',
          text: 'Sistema ser√° atualizado hoje √†s 23h',
          time: '3 dias atr√°s',
          status: 'read',
          badge: 'badge-info',
          badgeText: 'Sistema',
          prioridade: 'baixa'
        }
      ];
      renderNotifications();
    }

    // Obter √≠cone para tipo de notifica√ß√£o
    function getIconForType(type) {
      switch (type) {
        case 'publication': return 'fas fa-file-alt';
        case 'system': return 'fas fa-cog';
        case 'alert': return 'fas fa-exclamation-triangle';
        case 'success': return 'fas fa-check-circle';
        default: return 'fas fa-bell';
      }
    }

    // Obter classe de √≠cone para tipo
    function getIconClassForType(type) {
      switch (type) {
        case 'publication': return 'info';
        case 'system': return 'primary';
        case 'alert': return 'warning';
        case 'success': return 'success';
        default: return 'info';
      }
    }

    // Obter classe de badge para tipo
    function getBadgeClassForType(type) {
      switch (type) {
        case 'publication': return 'badge-primary';
        case 'system': return 'badge-secondary';
        case 'alert': return 'badge-warning';
        case 'success': return 'badge-success';
        default: return 'badge-info';
      }
    }

    // Obter texto do badge para tipo
    function getBadgeTextForType(type) {
      switch (type) {
        case 'publication': return 'Nova';
        case 'system': return 'Sistema';
        case 'alert': return 'Urgente';
        case 'success': return 'Sucesso';
        default: return 'Info';
      }
    }

    // Formatar timestamp
    function formatTimestamp(timestamp) {
      if (!timestamp) return 'agora';
      
      const now = new Date();
      const notifDate = new Date(timestamp);
      const diffMs = now - notifDate;
      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
      const diffDays = Math.floor(diffHours / 24);
      
      if (diffHours < 1) return 'agora';
      if (diffHours < 24) return `H√° ${diffHours} horas`;
      if (diffDays < 7) return `H√° ${diffDays} dias`;
      return notifDate.toLocaleDateString('pt-BR');
    }

    // Renderizar notifica√ß√µes
    function renderNotifications() {
      const container = document.getElementById('notificationsList');
      
      if (notifications.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-bell-slash"></i>
            <h4>Nenhuma notifica√ß√£o encontrada</h4>
            <p>N√£o h√° notifica√ß√µes para exibir no momento.</p>
          </div>
        `;
        return;
      }

      const filteredNotifications = getFilteredNotifications();
      
      container.innerHTML = filteredNotifications.map(notification => 
        createNotificationHTML(notification)
      ).join('');
    }

    // Obter notifica√ß√µes filtradas
    function getFilteredNotifications() {
      switch (currentFilter) {
        case 'unread':
          return notifications.filter(n => n.status === 'unread');
        case 'publications':
          return notifications.filter(n => n.type === 'publication');
        case 'system':
          return notifications.filter(n => n.type === 'system');
        case 'alerts':
          return notifications.filter(n => n.type === 'alert');
        default:
          return notifications;
      }
    }

    // Criar HTML de uma notifica√ß√£o
    function createNotificationHTML(notification) {
      const unreadClass = notification.status === 'unread' ? 'unread' : '';
      
      return `
        <div class="notification-item ${unreadClass}" data-id="${notification.id}">
          <div class="d-flex align-items-start">
            <div class="notification-icon ${notification.iconClass}">
              <i class="${notification.icon}"></i>
            </div>
            <div class="notification-content">
              <div class="notification-title">${notification.title}</div>
              <div class="notification-text">${notification.text}</div>
              <div class="notification-meta">
                <span class="notification-time">
                  <i class="fas fa-clock"></i> ${notification.time}
                </span>
                <div class="notification-actions">
                  <span class="badge ${notification.badge}">${notification.badgeText}</span>
                  ${notification.status === 'unread' ? 
                    `<button class="btn btn-sm btn-outline-success mark-read-btn" data-id="${notification.id}">
                      <i class="fas fa-check"></i> Marcar como lida
                    </button>` : ''
                  }
                  <button class="btn btn-sm btn-outline-secondary delete-btn" data-id="${notification.id}">
                    <i class="fas fa-trash"></i> Remover
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Configurar event listeners
    function setupEventListeners() {
      // Filtros
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          // Remover classe active de todos os bot√µes
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          // Adicionar classe active ao bot√£o clicado
          this.classList.add('active');
          
          // Atualizar filtro
          currentFilter = this.dataset.filter;
          renderNotifications();
        });
      });

      // Marcar como lida
      document.addEventListener('click', function(e) {
        if (e.target.closest('.mark-read-btn')) {
          const id = parseInt(e.target.closest('.mark-read-btn').dataset.id);
          markAsRead(id);
        }
      });

      // Remover notifica√ß√£o
      document.addEventListener('click', function(e) {
        if (e.target.closest('.delete-btn')) {
          const id = parseInt(e.target.closest('.delete-btn').dataset.id);
          removeNotification(id);
        }
      });
    }

    // Marcar notifica√ß√£o como lida
    function markAsRead(id) {
      const notification = notifications.find(n => n.id === id);
      if (notification) {
        notification.status = 'read';
        renderNotifications();
        showToast('Notifica√ß√£o marcada como lida', 'success');
      }
    }

    // Remover notifica√ß√£o
    function removeNotification(id) {
      if (confirm('Tem certeza que deseja remover esta notifica√ß√£o?')) {
        notifications = notifications.filter(n => n.id !== id);
        renderNotifications();
        showToast('Notifica√ß√£o removida', 'info');
      }
    }

    // Mostrar toast de notifica√ß√£o
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
      toast.style.cssText = 'top: 20px; right: 20px; z-index: 1050; min-width: 300px;';
      toast.innerHTML = `
        ${message}
        <button type="button" class="close" data-dismiss="alert">
          <span>&times;</span>
        </button>
      `;
      
      document.body.appendChild(toast);
      
      // Remover automaticamente ap√≥s 3 segundos
      setTimeout(() => {
        if (toast.parentNode) {
          toast.parentNode.removeChild(toast);
        }
      }, 3000);
    }
  </script>
</body>
</html>
